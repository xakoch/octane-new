document.addEventListener("DOMContentLoaded",function(){initScript(),requestAnimationFrame(()=>{})});let lenis;function initLenis(){try{"undefined"!=typeof Lenis&&(lenis&&(lenis.destroy(),lenis=null),lenis=new Lenis({duration:1.4,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e)),direction:"vertical",gestureDirection:"vertical",smooth:!0,mouseMultiplier:1,smoothTouch:!0,touchMultiplier:2,infinite:!1,wrapper:window,content:document.documentElement}),window.lenis=lenis,requestAnimationFrame(function e(t){lenis.raf(t),requestAnimationFrame(e)}))}catch(e){console.error("Error in "+arguments.callee.name+":",e)}}function initWindowInnerheight(){try{$(document).ready(()=>{var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",e+"px")})}catch(e){console.error("Error in "+arguments.callee.name+":",e)}}function initSwiperSlider(){try{"undefined"==typeof Swiper?console.warn("Swiper не найден"):(document.querySelector(".offers__slider")&&new Swiper(".offers__slider",{slidesPerView:1.2,centeredSlides:!0,spaceBetween:30,navigation:{nextEl:".offers__arrows-right",prevEl:".offers__arrows-left"},breakpoints:{1200:{slidesPerView:3,spaceBetween:30}},on:{init:function(){this.wrapperEl.classList.add("swiper-wrapper-reset"),setTimeout(()=>{this.wrapperEl.classList.remove("swiper-wrapper-reset"),this.slideNext(0)},100)}}}),console.log("Swiper sliders initialized successfully"))}catch(e){console.error("Error in initSwiperSlider:",e)}}function initFaq(){try{const n=document.querySelectorAll(".faq__item");0!==n.length&&n.forEach(t=>{var e=t.querySelector(".faq__header"),o=t.querySelector(".faq__text");e&&o&&e.addEventListener("click",()=>{var e=t.classList.contains("active");n.forEach(e=>{e!==t&&e.classList.contains("active")&&e.classList.remove("active")}),e?t.classList.remove("active"):(t.classList.add("active"),window.lenis&&setTimeout(()=>{window.lenis.resize()},300))})})}catch(e){console.error("Error in "+arguments.callee.name+":",e)}}function initFactsCounter(){try{var e=document.querySelectorAll(".counter");if(0!==e.length)if("undefined"==typeof gsap)console.warn("GSAP не найден, анимация счётчика не будет работать");else{const n=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){e=e.target;const t=e.querySelectorAll(".facts__item");gsap.fromTo(t,{opacity:0,y:30},{opacity:1,y:0,duration:.8,stagger:.15,ease:"power3.out",onStart:function(){t.forEach((e,t)=>{e=e.querySelector(".counter");e&&!e.classList.contains("animated")&&(e.classList.add("animated"),o(e,.15*t))})}}),n.unobserve(e)}})},{threshold:.3});var t=document.querySelector(".facts__bottom");t&&n.observe(t)}function s(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function o(n,e){const r=parseInt(n.getAttribute("data-target")),i=performance.now()+1e3*e;let a=0;requestAnimationFrame(function e(t){var o;t<i||(t-=i,t=Math.min(t/2e3,1),o=(1-Math.pow(1-t,4))*r,(o=Math.round(o))!==a&&(n.textContent=s(o),a=o),t<1)?requestAnimationFrame(e):n.textContent=s(r)})}}catch(e){console.error("Error in "+arguments.callee.name+":",e)}}function initHowAnimation(){try{if("undefined"==typeof gsap)console.warn("GSAP не найден, анимация How it Works не будет работать");else{var e=document.querySelector(".how");if(e){const t=e.querySelectorAll(".how__item"),n=e.querySelector(".how__actions");if(0!==t.length&&n){const r=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const o=gsap.timeline();t.forEach((e,t)=>{o.fromTo(e,{opacity:0,y:30},{opacity:1,y:0,duration:.6,ease:"power3.out"},.2*t)}),o.fromTo(n,{opacity:0,y:30},{opacity:1,y:0,duration:.8,ease:"back.out(1.7)"},"+=0.1"),r.unobserve(e.target)}})},{threshold:.5});r.observe(e)}}}}catch(e){console.error("Error in "+arguments.callee.name+":",e)}}function initTableAnimation(){try{if("undefined"==typeof gsap)console.warn("GSAP не найден, анимация Table не будет работать");else{var e=document.querySelector(".table");if(e){const r=e.querySelector(".section__title"),i=e.querySelectorAll(".header-item");var t=e.querySelector(".comp-table");if(r&&t){const a=[];var o=t.querySelectorAll(".comp-body"),n=o[0]?.querySelectorAll(".comp-row").length||0;for(let t=0;t<n;t++){const c=[];o.forEach(e=>{e=e.querySelectorAll(".comp-row")[t];e&&c.push(e)}),0<c.length&&a.push(c)}const s=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const o=gsap.timeline();o.fromTo(r,{opacity:0,y:30},{opacity:1,y:0,duration:.6,ease:"power3.out"}),o.fromTo(i,{opacity:0,y:20},{opacity:1,y:0,duration:.5,ease:"power3.out",stagger:0},"+=0.2"),a.forEach((e,t)=>{o.fromTo(e,{opacity:0,x:-20},{opacity:1,x:0,duration:.4,ease:"power2.out",stagger:0},"-="+(0===t?.2:.25))}),s.unobserve(e.target)}})},{threshold:.2});s.observe(e)}}}}catch(e){console.error("Error in "+arguments.callee.name+":",e)}}function initLazyLoad(){try{var e=document.querySelectorAll("img.lazy-load");if(0!==e.length){const t=new IntersectionObserver((e,r)=>{e.forEach(e=>{if(e.isIntersecting){const o=e.target;var e=o.getAttribute("data-src"),t=o.getAttribute("data-mobile");const n=window.innerWidth<=768&&t?t:e;n&&((t=new Image).onload=()=>{o.style.opacity="0",setTimeout(()=>{o.src=n,o.removeAttribute("data-src"),o.removeAttribute("data-mobile"),o.classList.add("loaded"),setTimeout(()=>{o.style.opacity="1"},50)},300)},t.src=n,r.unobserve(o))}})},{rootMargin:"50px"});e.forEach(e=>{t.observe(e)})}}catch(e){console.error("Error in "+arguments.callee.name+":",e)}}function initSpecials(){try{var e=document.querySelectorAll(".specials__item");0!==e.length&&e.forEach(t=>{const o=t.querySelector(".link");if(o){const n=o.textContent;o.addEventListener("click",e=>{e.preventDefault(),t.classList.contains("expanded")?(t.classList.remove("expanded"),o.textContent=n):(t.classList.add("expanded"),o.textContent="hide"),window.lenis&&setTimeout(()=>{window.lenis.resize()},400)})}})}catch(e){console.error("Error in "+arguments.callee.name+":",e)}}function initPopups(){try{const n={app:document.getElementById("appPopup"),form:document.getElementById("formPopup"),card:document.getElementById("cardPopup")};function s(e){e.classList.remove("active"),setTimeout(()=>{document.body.style.overflow="",window.lenis&&window.lenis.start()},300)}document.addEventListener("click",e=>{var t,o=e.target.closest("[data-popup]");o&&(e.preventDefault(),e=o.getAttribute("data-popup"),o=n[e])&&(t=o,requestAnimationFrame(()=>{t.classList.add("active"),document.body.style.overflow="hidden",window.lenis&&window.lenis.stop()}))}),Object.values(n).forEach(e=>{var t,o;e&&(t=e.querySelector(".app-popup__overlay, .form-popup__overlay"),o=e.querySelector(".app-popup__close, .form-popup__close"),t&&t.addEventListener("click",()=>s(e)),o)&&o.addEventListener("click",()=>s(e))}),document.addEventListener("keydown",e=>{"Escape"===e.key&&Object.values(n).forEach(e=>{e&&e.classList.contains("active")&&s(e)})}),[{id:"savingForm",message:"Thank you! We will contact you shortly."},{id:"cardForm",message:"Thank you! Your card application has been submitted. We will contact you shortly."}].forEach(({id:r,message:i})=>{const a=document.getElementById(r);a&&a.addEventListener("submit",async e=>{e.preventDefault();var e=a.querySelector(".form-popup__submit"),t=e.textContent,o=(e.disabled=!0,e.textContent="Sending...",new FormData(a)),o=Object.fromEntries(o);try{await new Promise(e=>setTimeout(e,1500)),console.log(`Form ${r} submitted:`,o),alert(i),a.reset();var n=a.closest(".form-popup");n&&s(n)}catch(e){console.error("Form submission error:",e),alert("Something went wrong. Please try again.")}finally{e.disabled=!1,e.textContent=t}})})}catch(e){console.error("Error in initPopups:",e)}}function initScript(){try{initLenis(),initWindowInnerheight(),initSwiperSlider(),initFaq(),initSpecials(),initLazyLoad(),initFactsCounter(),initHowAnimation(),initTableAnimation(),initPopups()}catch(e){console.error("Error in "+arguments.callee.name+":",e)}}